---
title: "HSBC_data"
author: "Rikke Uldb√¶k"
date: "9/5/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#loading packages
pacman::p_load(ggplot2, tidyverse)

setwd("~/Desktop/OneDrive - Aarhus Universitet/Cognitive Science/5th semester/Cultural Datascience/EXAM") 
```


### loading data


```{r}
# Loading files from google drive 
id_2014 <- "1Nes6x0xB-M2tnPu4DA0AJbD0hVuiXDc4" # google file ID - hbsc 2014
hbsc2014<- read.csv(sprintf("https://docs.google.com/uc?id=%s&export=download", id_2014)) # data hbsc 2014


id_2010 <- "1HQ-nJVChpRXWwWEwumE1yOcPsGDtUDNU" # google file ID - hbsc 2010
hbsc2010<- read.csv(sprintf("https://docs.google.com/uc?id=%s&export=download", id_2010)) # data hbsc 2010


id_2006 <- "1PXtYqpDvnO0YQ774623NiRZY38te8oes" # google file ID - hbsc 2006
hbsc2006<- read.csv(sprintf("https://docs.google.com/uc?id=%s&export=download", id_2006)) # data hbsc 2006


id_2001 <- "1c8toBLgCl5BLy6yGUkDlpK_XK0i1E5pV" # google file ID - hbsc 2001
hbsc2001<- read.csv(sprintf("https://docs.google.com/uc?id=%s&export=download", id_2001)) # data hbsc 2001
ls.str(hbsc2001)

```


### Overview
```{r}
ls.str(hbsc2014)
```

_Interessante ideer?_
- Diet and nutrition in school-aged children across countries ?
```{r}
head(hbsc2014$breakfastwd) #breakfast weekdays
head(hbsc2014$breakfastwe) #breakfast weekends
head(hbsc2014$fruits) # eat fruits 
head(hbsc2014$vegetables) #eat vegetables
head(hbsc2014$sweets) #eat sweets
head(hbsc2014$softdrinks) #drink coke/soft drinks
head(hbsc2014$m11) #family meal breakfast
head(hbsc2014$m12) #family meal evening
head(hbsc2014$ondiet) #on a diet
head(hbsc2014$toothbr) #tooth brushing
```

- Life satisfaction
- Sleep difficulty? 
```{r}
#sleep variables
head(hbsc2014$sleepdifficulty) #difficulties in sleeping

```

- Mental health
```{r}
head(hbsc2014$thinkbody) #think about body
head(hbsc2014$headache) #headache
head(hbsc2014$stomachache) #stomachache
head(hbsc2014$backache) #backache
head(hbsc2014$feellow) #feeling low
head(hbsc2014$irritable) #irritability or bad temper
head(hbsc2014$nervous) #feeling nervous
head(hbsc2014$sleepdifficulty) #difficulties in sleeping
head(hbsc2014$dizzy) # feeling dizzy
head(hbsc2014$health) #health
head(hbsc2014$lifesat) #life satisfaction

hist(hbsc2014$lifesat)
length(which(!is.na(hbsc2014$lifesat))) #205953 responses, ~ 8000 NA's 


#Quick try
new <- hbsc2014 %>% 
  filter(COUNTRYno == c("Denmark", "Sweden", "Norway", "Finland"))


scandinavian_model <- glm(lifesat ~ sleepdificulty + nervous + irritable +thinkbody+ dizzy + health +feellow+headache +stomachache+ backache, data= new)
summary(scandinavian_model)


```


- Drinking culture

- Sex
```{r}
head(hbsc2014$agesex)
length(which(!is.na(hbsc2014$agesex))) #only 13417 answers

```


_Others have done:_
- Trends of overweight and obesity, physical activity and sedentary behaviour in Czech schoolchildren: HBSC study



### Changing country.no to country name
Note, there are no data from Turkey and USA, see distribution of answers on page 23-24 of the pdf
( https://www.uib.no/sites/w3.uib.no/files/attachments/hbsc-2013_14_ed.1.0.pdf )
```{r}
hbsc2014$COUNTRYno <- (ifelse(hbsc2014$COUNTRYno == "8000","Albania", ifelse(hbsc2014$COUNTRYno == "40000", "Austria", ifelse(hbsc2014$COUNTRYno == "51000","Armenia", ifelse(hbsc2014$COUNTRYno == "8000","Albania", ifelse(hbsc2014$COUNTRYno == "56001","Belgium (Flemish)", ifelse(hbsc2014$COUNTRYno == "56002","Belgium (French)", ifelse(hbsc2014$COUNTRYno == "100000","Bulgaria", ifelse(hbsc2014$COUNTRYno == "124000","Canada", ifelse(hbsc2014$COUNTRYno == "191000","Croatia",ifelse(hbsc2014$COUNTRYno == "203000","Czech Republic",ifelse(hbsc2014$COUNTRYno == "208000","Denmark",ifelse(hbsc2014$COUNTRYno == "233000","Estonia",ifelse(hbsc2014$COUNTRYno == "246000","Finland",ifelse(hbsc2014$COUNTRYno == "250000","France",ifelse(hbsc2014$COUNTRYno == "276000","Germany",ifelse(hbsc2014$COUNTRYno == "300000","Greece",ifelse(hbsc2014$COUNTRYno == "304000","Greenland",ifelse(hbsc2014$COUNTRYno == "348000","Hungary",ifelse(hbsc2014$COUNTRYno == "352000","Iceland",ifelse(hbsc2014$COUNTRYno == "372000","Ireland",ifelse(hbsc2014$COUNTRYno == "376000","Israel",ifelse(hbsc2014$COUNTRYno == "380000","Italy",ifelse(hbsc2014$COUNTRYno == "428000","Latvia",ifelse(hbsc2014$COUNTRYno == "440000","Lithuania",ifelse(hbsc2014$COUNTRYno == "442000","Luxembourg",ifelse(hbsc2014$COUNTRYno == "470000","Malta",ifelse(hbsc2014$COUNTRYno == "498000","Republic of Moldova",ifelse(hbsc2014$COUNTRYno == "528000","Netherlands",ifelse(hbsc2014$COUNTRYno == "578000","Norway",ifelse(hbsc2014$COUNTRYno == "616000","Poland",ifelse(hbsc2014$COUNTRYno == "620000","Portugal",ifelse(hbsc2014$COUNTRYno == "642000","Romania",ifelse(hbsc2014$COUNTRYno == "643000","Russia",ifelse(hbsc2014$COUNTRYno == "703000","Slovakia",ifelse(hbsc2014$COUNTRYno == "705000","Slovenia",ifelse(hbsc2014$COUNTRYno == "724000","Spain",ifelse(hbsc2014$COUNTRYno == "752000","Sweden",ifelse(hbsc2014$COUNTRYno == "756000","Switzerland",ifelse(hbsc2014$COUNTRYno == "792000","Turkey",ifelse(hbsc2014$COUNTRYno == "804000","Ukraine",ifelse(hbsc2014$COUNTRYno == "807000","Macedonia",ifelse(hbsc2014$COUNTRYno == "826001","England",ifelse(hbsc2014$COUNTRYno == "826002","Scotland",ifelse(hbsc2014$COUNTRYno == "826003","Wales",ifelse(hbsc2014$COUNTRYno == "840000","USA", NA))))))))))))))))))))))))))))))))))))))))))))))

```



```{r}
#loading packages
pacman::p_load(ggplot2, tidyverse)

#quick plot
ggplot(data = hbsc2014, aes(x= sex, y=drunk, colour = COUNTRYno ))+ geom_histogram(stat="identity")+
  facet_wrap(~COUNTRYno)+
  labs(x = "x", y = "y")+
  ggtitle("Per country")+
  theme_minimal()

#quick plot
ggplot(hbsc2014, aes(softdrinks, colour = COUNTRYno)) +
geom_histogram(aes(y = ..density..)) + stat_function(fun = dnorm, args = list(mean = mean(df$balloon),
sd = sd(hbsc2014$softdrinks)), colour = "red", size = 1) + theme_bw()+
  facet_wrap(~COUNTRYno)+
  labs(x = "Softdrinks", y = "y")+
  ggtitle("Softdrink consumption per country")+
  theme_minimal()


ggplot(hbsc2014, aes(lifesat, colour = COUNTRYno)) +
geom_histogram(aes(y = ..density..)) + stat_function(fun = dnorm, args = list(mean = mean(df$balloon),
sd = sd(hbsc2014$softdrinks)), colour = "red", size = 1) + theme_bw()+
  facet_wrap(~COUNTRYno)+
  labs(x = "Softdrinks", y = "y")+
  ggtitle("Life satisfaction score per country")+
  theme_minimal()


```

